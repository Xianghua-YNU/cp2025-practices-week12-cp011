# 中子共振散射实验数据分析 - 实验报告

## 1. 实验目的

本实验旨在通过分析中子共振散射实验数据，掌握两种插值方法(拉格朗日多项式和三次样条)的实现和应用。具体目标包括：

- 理解并实现拉格朗日多项式插值算法
- 理解并实现三次样条插值算法
- 学习使用插值方法分析实验数据中的共振峰特性
- 比较不同插值方法的结果和适用性

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 拉格朗日多项式插值的实现方式：用多项式曲线穿过所有已知数据点
  实现方法如下：
  '''from scipy.interpolate import lagrange

# 假设已有实验数据点 x_data 和 y_data
poly = lagrange(x_data, y_data)  # 生成拉格朗日多项式

# 在新坐标x_new处插值
y_interp = poly(x_new) 

# 假设已有实验数据点 x_data 和 y_data
poly = lagrange(x_data, y_data)  # 生成拉格朗日多项式

# 在新坐标x_new处插值
y_interp = poly(x_new) '''
-
- 三次样条插值的实现方式
  '''from scipy.interpolate import CubicSpline

# 生成三次样条函数
cs = CubicSpline(x_data, y_data, bc_type='natural')  # 'natural'表示两端二阶导为0

# 插值计算
y_spline = cs(x_new)'''
- 共振峰位置和半高全宽(FWHM)的计算方法
- '''peak_idx = np.argmax(y_interp)  # 找到插值后数据的最大值索引
peak_x = x_new[peak_idx]        # 对应的x坐标即峰位置'''
- 可视化实现的关键步骤
  '''plt.figure(figsize=(10,6))

# 1. 绘制原始数据点
plt.scatter(x_data, y_data, c='red', label='原始数据')

# 2. 绘制拉格朗日插值曲线
plt.plot(x_new, y_interp, '--', label='拉格朗日插值')

# 3. 绘制样条插值曲线
plt.plot(x_new, y_spline, '-', label='三次样条')

# 4. 标记共振峰
plt.axvline(peak_x, color='gray', linestyle=':')
plt.text(peak_x, np.max(y_interp), f'共振峰: {peak_x:.2f}')

# 5. 标记FWHM
plt.hlines(half_max, x_new[left_idx], x_new[right_idx], colors='green', linestyles='--')
plt.text((x_new[left_idx]+x_new[right_idx])/2, half_max, f'FWHM={fwhm:.2f}', va='bottom')

plt.legend()
plt.xlabel('能量(eV)')
plt.ylabel('散射强度')
plt.title('中子共振散射插值分析')
plt.grid(True)
plt.show()'''

## 3. 实验结果

### 3.1 插值结果对比

请在此处描述两种插值方法的实现结果：

1. 拉格朗日多项式插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：______ MeV
   - 计算得到的FWHM：______ MeV

2. 三次样条插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：______ MeV
   - 计算得到的FWHM：______ MeV

### 3.2 插值曲线图

请在此处插入你绘制的插值曲线对比图(原始数据点和两种插值曲线)。图表应包含以下元素：

- 原始数据点(带误差棒)
- 拉格朗日插值曲线
- 三次样条插值曲线
- 图表标题："Neutron Resonance Scattering Cross Section Analysis"
- X轴标签："Energy (MeV)"
- Y轴标签："Cross Section (mb)"
- 图例，包括数据点和两种插值曲线的说明

### 3.3 核心代码片段

请在此处粘贴你实现的代码：

```python
[STUDENT_CODE_HERE]
```
## 4. 分析与讨论
### 4.1 插值方法比较
请分析两种插值方法的结果差异，讨论：

1. 曲线平滑度比较
2. 边界行为差异
3. 计算效率比较
4. 哪种方法更适合本实验数据？为什么？
### 4.2 共振峰分析
请讨论你得到的共振峰位置和FWHM结果：

1. 与原始数据峰值位置的比较
2. 两种插值方法结果的差异
3. 可能的误差来源
### 4.3 思考题
1. 对于这种类型的实验数据，为什么三次样条插值通常比高阶多项式插值更合适？
2. 如果数据点更密集或更稀疏，会对插值结果产生什么影响？
## 5. 结论
请总结本次实验的主要发现和收获，特别是：

- 对两种插值方法特点的理解
- 中子共振散射数据分析的经验
- 插值方法选择对结果分析的影响
